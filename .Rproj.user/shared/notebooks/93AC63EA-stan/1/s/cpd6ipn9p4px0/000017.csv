"0","library(cmdstanr)"
"0",""
"0","stan_code <- '"
"0","data {"
"0","  int<lower=0> P;"
"0","  int<lower=0> N_m;"
"0","  matrix[N_m,P] X_m;"
"0","  vector[N_m] y_m;"
"0","  int<lower=0> N_o;"
"0","  matrix[N_o,P] X_o;"
"0","  array[N_o] real y_o;"
"0","}"
"0","parameters {"
"0","  vector[P] beta;"
"0","  real<lower=0> alpha;"
"0","}"
"0","transformed parameters{"
"0","  vector[N_m] lambda_m;"
"0","  vector[N_o] lambda_o;"
"0","  lambda_m = exp((X_m*beta)*alpha);"
"0","  lambda_o = exp((X_o*beta)*alpha);"
"0","}"
"0","model {"
"0","  beta ~ normal(0, 100);"
"0","  alpha ~ exponential(1);"
"0","  target += weibull_lpdf(y_o | alpha, lambda_o);"
"0","  target += weibull_lccdf(y_m | alpha, lambda_m);"
"0","}"
"0","generated quantities{"
"0","  vector[1000] post_pred_trt;"
"0","  vector[1000] post_pred_pbo;"
"0","  real lambda_trt;"
"0","  real lambda_pbo;"
"0","  real hazard_ratio;"
"0",""
"0","  lambda_trt = exp((beta[1] + beta[2])*alpha );"
"0","  lambda_pbo = exp((beta[1])*alpha );"
"0","  hazard_ratio = exp(beta[2]*alpha );"
"0",""
"0","  for(i in 1:1000){"
"0","    post_pred_trt[i] = weibull_rng(alpha,  lambda_trt);"
"0","    post_pred_pbo[i] = weibull_rng(alpha,  lambda_pbo);"
"0","  }"
"0","}"
"0","'"
"0",""
"0","# write code to a .stan file, then compile"
"0","stan_file <- write_stan_file(stan_code)"
"0","weibull_mod <- cmdstan_model(stan_file)   # <-- compiled model object"
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1"," "
